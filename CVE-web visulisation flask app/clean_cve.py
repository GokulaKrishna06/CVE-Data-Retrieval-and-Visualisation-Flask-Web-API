import json

def cleanse_and_deduplicate(json_file_path):
    # Load JSON data from file
    with open(json_file_path, 'r') as file:
        data = json.load(file)

    # Dictionary to store unique CVEs
    unique_cves = {}

    # Iterate through vulnerabilities in the JSON data
    for vulnerability in data['vulnerabilities']:
        cve_id = vulnerability['cve']['id']

        # Check if CVE already exists in unique_cves dictionary
        if cve_id not in unique_cves:
            # If not, add it to the dictionary
            unique_cves[cve_id] = vulnerability

    # Convert dictionary values back to a list
    unique_vulnerabilities = list(unique_cves.values())

    # Update data with unique CVEs
    data['vulnerabilities'] = unique_vulnerabilities

    # Write cleansed and de-duplicated data back to the file
    with open(json_file_path, 'w') as file:
        json.dump(data, file, indent=4)

# Example usage
json_file_path = 'cve.json'
cleanse_and_deduplicate(json_file_path)
