from pymongo import MongoClient
import requests

# Function to fetch and insert data into MongoDB
def fetch_and_insert_data():
    # MongoDB connection setup
    client = MongoClient('localhost', 27017)
    db = client['cve_api']
    collection = db['cve_data']

    # NVD API URL
    url = "https://services.nvd.nist.gov/rest/json/cves/2.0"

    response = requests.get(url)

    if response.status_code == 200:
        data = response.json()['vulnerabilities']
        
        collection.insert_many(data)
        print("Data inserted into MongoDB successfully.")
    else:
        print("Failed to retrieve data from NVD API:", response.status_code)

# Execute the fetch_and_insert_data function if this file is run directly
if __name__ == "__main__":
    fetch_and_insert_data()
